<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>helloHQ API Documentation</title>
    <link rel="shortcut icon" href="./img/favicon-32x32.png" type="image/x-icon">
    <link rel="stylesheet" href="./styles.css">
    <script src="https://unpkg.com/swagger-ui-dist@4.5.0/swagger-ui-bundle.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,800"/>
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/swagger-ui-dist@4.5.0/swagger-ui.css"/>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <script>
        Prism.languages.http =
        {
            'method': {
                pattern: /^(GET|POST|PUT|DELETE|PATCH|OPTIONS|HEAD)\b/gm,
            },
            'keyword': {
                pattern: /[?&$](client_id|state|redirect_uri|scope|response_type|code|client_secret|grant_type|refresh_token|expand|filter|top|skip|orderby)/gm,
            }
            
        };
        Prism.languages.webmanifest = Prism.languages.http;

    </script>
    <title>helloHQ API documentation</title>
</head>
<body>
<div class="navbar">
    <a href="https://developer-v2.hellohq.io">
        <img class="_cell logo" src="./img/developer-logo.svg" border="0" alt="helloHQ Developer Logo">
    </a>
    <ul>
        <li class="dropdown">
            <a id="api_v1" href="javascript:void(0)">API v1</a>
            <div class="dropdown-content">
                <a href="#" onclick="scrollToHeadline('v1_auth')">Authentication</a>
                <a href="#" onclick="scrollToHeadline('v1_expand')">Expand</a>
                <a href="#" onclick="scrollToHeadline('v1_filter')">Filter</a>
                <a href="#" onclick="scrollToHeadline('v1_http_convention')">HTTP Conventions</a>
                <a href="#" onclick="scrollToHeadline('v1_endpoints')">Endpoints</a>
            </div>
        </li>
        <li class="dropdown">
            <a id="api_v2" href="javascript:void(0)">API v2</a>
            <div class="dropdown-content">
                <a href="#content1" onclick="scrollToHeadline('v2_auth')">Authentication</a>
                <a href="#content5" onclick="scrollToHeadline('v2_permissions')">Permissions</a>
                <a href="#content2" onclick="scrollToHeadline('v2_filter')">Filtering</a>
                <a href="#content3" onclick="scrollToHeadline('v2_order')">Ordering</a>
                <a href="#content4" onclick="scrollToHeadline('v2_pagination')">Pagination</a>
                <a href="#content6" onclick="scrollToHeadline('v2_rate')">Rate Limits</a>
                <a href="#content6" onclick="scrollToHeadline('v2_endpoints')">Endpoints</a>
            </div>
        </li>
        <li>
            <a href="https://github.com/hellohq-io/hellohq.docs/issues" target="_blank">Community</a>
        </li>
    </ul>
</div>

<div id="content-wrapper">
    <!-- Introduction Section -->
    <div style="padding:25px 45px 20px 40px;">
        <div id="default-content">
            <h1><strong>Welcome to the helloHQ API Documentation</strong></h1>
            <p>
                The helloHQ API provides developers with access to various entities and business logic within the
                helloHQ platform.
                It is available in two versions: <strong>v1</strong> (OData 4.0 standard) and <strong>v2</strong> (REST
                standard).
                This documentation will guide you through using the API to integrate and interact with the helloHQ
                system effectively.
            </p>
            <p><strong>Base URL:</strong> <code>https://api.hellohq.io</code></p>

            <h1 id="introduction">Introduction</h1>
            <p>
                The helloHQ API is available in two versions, each serving different needs and functionalities. Below is
                a brief overview:
            </p>
            <h3>API Version 1 (v1)</h3>
            <p>
                The initial version of our API is based on the OData 4.0 standard, allowing extensive access to the
                helloHQ platform.
                It covers all entities available in helloHQ 1.9. However, this version does not support the new
                financial processes.
            </p>
            <h3>API Version 2 (v2)</h3>
            <p>
                The second version is built around the REST standard and focuses on the new financial processes in
                helloHQ 2.0.
                It is currently under active development, with new endpoints being added regularly.
            </p>
            <p><strong>Note:</strong> Before you start using the API, ensure that your client application is registered
                in the helloHQ admin panel.</p>

            <h1 id="further-references">Further References</h1>
            <p>For additional information, please refer to the following resources:</p>
            <ul>
                <li><strong>OData</strong>: <a href="http://www.odata.org/">http://www.odata.org/</a></li>
                <li><strong>OData v4.0 Protocol</strong>: <a
                        href="http://docs.oasis-open.org/odata/odata/v4.0/odata-v4.0-part1-protocol.html">OData v4.0
                    Protocol</a></li>
                <li><strong>OAuth 2.0</strong>: <a href="http://oauth.net/2/">http://oauth.net/2/</a></li>
                <li><strong>helloHQ Help Center</strong>: <a href="http://help.hellohq.io">http://help.hellohq.io</a>
                </li>
            </ul>
        </div>
    </div>

    <!-- Authentication Section -->
    <div id="v1_auth" class="content">
        <h1 id="v1">API Version 1 (v1)</h1>
        <h2 id="authentication">Authentication</h2>
        <p>The helloHQ API uses <a href="https://oauth.net/2/">OAuth 2.0</a> for secure authentication.</p>
        <h2 id="getting-started">Getting Started with OAuth 2.0</h2>
        <p>
            OAuth 2.0 is a protocol for secure authorization. It provides access tokens instead of credentials, which
            are used for a limited time.
            Each client application must be registered in helloHQ to obtain the necessary <code>App Id</code> and <code>App
            Secret</code>.
        </p>
        <h3 id="client-application">Registering a Client Application</h3>
        <p>
            Register your client application in the helloHQ admin panel to obtain the <code>App Id</code> and <code>App
            Secret</code>.
            These are required to authenticate against the API. Use the format <code>{customer-id}-{client-id}</code>
            for the <code>App Id</code>.
        </p>
        <h3 id="app-id">App Id</h3>
        <p>The <code>App Id</code> is a unique identifier that consists of your HQ customer id and the client
            application id, e.g., <code>12345-clientapp</code>.</p>
        <h3 id="app-secret">App Secret</h3>
        <p>The <code>App Secret</code> is generated in the admin panel. It is used alongside the <code>App Id</code> to
            authenticate the client application.</p>
        <h3 id="scopes">Scopes</h3>
        <p>Scopes define the permissions granted to the application by the user. Supported scopes include:</p>
        <ul>
            <li><code>read_all</code>: Read access to all resources.</li>
            <li><code>write_all</code>: Write access to all resources.</li>
        </ul>
        <h3 id="access-token">Access Token</h3>
        <p>The <code>Access Token</code> is used to authenticate API requests and must be included in every request.
            Tokens are unique to each user and expire after a few days.</p>
        <h3 id="refresh-token">Refresh Token</h3>
        <p>A <code>Refresh Token</code> is used to obtain a new <code>Access Token</code> when the original has expired.
            It is only invalidated when the user revokes it.</p>
        <h3 id="oauth-endpoints">OAuth Endpoints</h3>
        <p>The following endpoints are used for OAuth authentication:</p>
        <ul>
            <li><code>/Account/Authorize</code>: Retrieve an authorization code.</li>
            <li><code>/Token</code>: Obtain an access token or refresh token.</li>
        </ul>
        <h3 id="authorization-flow">Authorization Flow</h3>
        <p>The OAuth 2.0 Authorization <code>Code Grant</code> flow is used by client applications. It involves the
            following steps:</p>
        <h4 id="authorization-request">Authorization Request</h4>
        <p>
            The client constructs the authorization request URI with the necessary parameters and redirects the user to
            the constructed URI using a browser window.
            The user logs in and grants the requested permissions.
        </p>
        <p><strong>Parameters:</strong></p>
        <ul>
            <li><code>client_id</code>: The client id of the application.</li>
            <li><code>state</code>: A unique string to maintain state between the request and callback.</li>
            <li><code>redirect_uri</code>: The URI to redirect to after the user grants permission.</li>
            <li><code>scope</code>: A space-separated list of requested scopes.</li>
        </ul>
        <p><strong>Example:</strong></p>
        <div class="code-container" onclick="copyToClipboard(this)">
            <button class="copy-button">Copy</button>
            <pre><code class="language-http">GET https://api.hqlabs.de/Account/Authorize?response_type=code&client_id=1234-testapp&state=xyz&redirect_uri=https://client.example.com/cb&scope=read_all write_all</code></pre>
        </div>
        <p><strong>Note:</strong> Open the generated URL in a browser window for the user to log in and authorize the
            application.</p>

        <h4 id="access-token-request">Access Token Request</h4>
        <p>
            After receiving the authorization code, the client sends a POST request to the token endpoint with the
            following parameters to obtain the access token.
        </p>
        <p><strong>Parameters:</strong></p>
        <ul>
            <li><code>code</code>: The authorization code received from the previous response.</li>
            <li><code>redirect_uri</code>: The redirect URI used in the previous step.</li>
            <li><code>Authorization</code>: Basic HTTP Authorization header containing the Base64-encoded <code>AppId:AppSecret</code>.
            </li>
        </ul>
        <p><strong>Example:</strong></p>
        <div class="code-container" onclick="copyToClipboard(this)">
            <button class="copy-button">Copy</button>
            <pre><code class="language-http">POST https://api.hqlabs.de/Token?grant_type=authorization_code&code=MWG5HTnFn9n8HJ&client_id=1234-testapp&client_secret=fkgjqoer9tfiealdkcmakwhdf&scope=read_all write_all</code></pre>
        </div>
        <p><strong>Note:</strong> Ensure that all query parameters are properly URL-encoded.</p>
    </div>


    <div id="v1_expand" class="content">
        <h2 id="expand">Expand</h2>
        <p>Expand options allow you to include related entities and navigation properties in a single query. This can be
            useful to avoid making multiple API calls.</p>
        <p>Use the <code>$expand=</code> parameter in the URL to specify the entities you want to include in your query.
            Here are some examples:</p>

        <h3>Expand a Single Property</h3>
        <ul>
            <li>Example: Expand the default address of a company:</li>
        </ul>
        <div class="code-container" onclick="copyToClipboard(this)">
            <button class="copy-button">Copy</button>
            <pre><code class="language-http">GET /v1/Companies?$expand=DefaultAddress</code></pre>
        </div>
        <h3>Expand Multiple Properties</h3>
        <ul>
            <li>Example: Expand the default address and company types of a company:</li>
        </ul>
        <div class="code-container" onclick="copyToClipboard(this)">
            <button class="copy-button">Copy</button>
            <pre><code class="language-http">GET /v1/Companies?$expand=DefaultAddress,CompanyTypes</code></pre>
        </div>
        <h3>Expand Multiple Levels</h3>
        <ul>
            <li>Example: On an invoice, expand positions and their custom fields:</li>
        </ul>
        <div class="code-container" onclick="copyToClipboard(this)">
            <button class="copy-button">Copy</button>
            <pre><code class="language-http">GET /v1/Invoices?$expand=Positions($expand=CustomFields)</code></pre>
        </div>
        <p><strong>Note:</strong> Be cautious when using multiple expanded levels as it can lead to complex and
            long-running queries.</p>
    </div>

    <div id="v1_filter" class="content">
        <h2 id="filter">Filter</h2>
        <p>Filters are used to query specific subsets of data, reducing the amount of data retrieved and processed on
            the client-side.</p>
        <p>Use the <code>$filter=</code> parameter in the URL to apply filters. If filtering on a sub-entity, ensure you
            expand it first. Here are some examples:</p>

        <h3>Filter by Date and Time</h3>
        <ul>
            <li>Example: Get all companies updated since January 26th, 2018:</li>
        </ul>
        <div class="code-container" onclick="copyToClipboard(this)">
            <button class="copy-button">Copy</button>
            <pre><code class="language-http">GET /v1/Companies?$filter=UpdatedOn ge 2018-01-26</code></pre>
        </div>
        <h3>Filter by Company Type</h3>
        <ul>
            <li>Example: Find all companies of a specific type (e.g., Customer) by ID:</li>
        </ul>
        <div class="code-container" onclick="copyToClipboard(this)">
            <button class="copy-button">Copy</button>
            <pre><code class="language-http">GET /v1/Companies?$expand=CompanyTypes&$filter=CompanyTypes/any(c: c/Id eq 4002)</code></pre>
        </div>
        <ul>
            <li>Example: Find all companies of a specific type (e.g., Supplier) by name:</li>
        </ul>
        <div class="code-container" onclick="copyToClipboard(this)">
            <button class="copy-button">Copy</button>
            <pre><code class="language-http">GET /v1/Companies?$expand=CompanyTypes&$filter=CompanyTypes/any(c: c/Name eq 'Supplier')</code></pre>
        </div>
    </div>
    <div id="v1_http_convention" class="content">
        <h2 id="http-conventions">HTTP Conventions</h2>
        <h3 id="response-types">Response Types</h3>
        <p>All API responses are in JSON format, following the OData 4 definition. Binary data, such as PDFs and images,
            can also be accessed via the API.</p>
        <p><strong>Example:</strong> To access an invoice PDF, use the following URL format:</p>
        <div class="code-container" onclick="copyToClipboard(this)">
            <button class="copy-button">Copy</button>
            <pre><code class="language-http">GET /v1/Invoices(id)/DocumentFile/$value</code></pre>
        </div>
        <h3 id="http-codes">HTTP Status Codes</h3>
        <p>Each response indicates the success or failure of a request through status codes. Here are some common
            codes:</p>
        <h4>Success Codes</h4>
        <ul>
            <li><code>200 OK</code>: The request was successful.</li>
            <li><code>201 Created</code>: The request was successful, and a new resource was created.</li>
            <li><code>204 No Content</code>: The request was successful, but no content is returned.</li>
        </ul>
        <h4>Error Codes</h4>
        <ul>
            <li><code>400 Bad Request</code>: The request was invalid or cannot be processed.</li>
            <li><code>401 Unauthorized</code>: Authentication is required or has failed.</li>
            <li><code>404 Not Found</code>: The requested resource could not be found.</li>
            <li><code>429 Too Many Requests</code>: Rate limit exceeded. Retry after some time.</li>
        </ul>
    </div>

    <h1>Endpoints</h1>
    <div id="v1_endpoints" class="content">
    </div>

    <!-- Content for API v2 similar to v1 -->
    <div id="v2_auth" class="content">
        <h1 id="v2">API Version 2 (v2)</h1>
        <h2>Authentication</h2>
        <p>Authentication is mandatory to access the helloHQ API. You need a valid access token to verify your identity
            and ensure you have the necessary permissions to access the requested resources.</p>
        <h3>Obtaining an Access Token</h3>
        <p>To obtain an access token, go to your helloHQ system:</p>
        <p><strong>Admin &gt; Settings &gt; API Clients</strong></p>
        <p>Click the green plus button to create a new token.</p>
        <img src="./img/create_client.png" alt="Create API Client"/>

        <p>In the overview, you can see all tokens for your system. Use the three-dot menu on the right side to copy or
            delete a token.</p>
        <img src="./img/api_clients.png" alt="API Clients Overview"/>

        <p>The token contains information about the client and the user. All options can be specified when a new token
            is created.</p>
    </div>

    <div id="v2_permissions" class="content">
        <h2>Permissions</h2>
        <p>Proper permission management is essential for API access control in helloHQ. You can choose between two types
            of access tokens: <strong>Sync Token</strong> and <strong>User Token</strong>.</p>

        <h3>Sync Token</h3>
        <p>
            A sync token is used to access the API without a user context. This token grants access to all data in the
            system, making it ideal for synchronization between helloHQ and your application.
        </p>

        <h3>User Token</h3>
        <p>
            A user token provides access to the API with a user context. This means that the token contains information
            about the user and only allows access to data that the user has permissions for. This is particularly useful
            when working within subsystems.
        </p>
    </div>

    <div id="v2_filter" class="content">
        <h1>Filtering</h1>
        <p>The helloHQ API supports a comprehensive set of filters that can be applied to all API endpoints. It is
            important to encode your URLs correctly:</p>
        <div class="code-container">
            <pre class="language-http"><code>filter=name eq 'hello %26 hq' <- correct
filter=name eq 'hello & hq' <- incorrect</code></pre>
        </div>

        <h2>Supported Operators</h2>
        <p>Use the following operators to filter data according to your needs:</p>
        <div class="table-wrapper">
            <table>
                <tr>
                    <th>Operator</th>
                    <th>Description</th>
                    <th>Example</th>
                </tr>
                <tr>
                    <td>eq</td>
                    <td>Equal to</td>
                    <td><code>filter=name eq 'hellohq'</code></td>
                </tr>
                <tr>
                    <td>ne</td>
                    <td>Not equal to</td>
                    <td><code>filter=name ne 'hellohq'</code></td>
                </tr>
                <tr>
                    <td>gt</td>
                    <td>Greater than</td>
                    <td><code>filter=price gt 18</code></td>
                </tr>
                <tr>
                    <td>ge</td>
                    <td>Greater than or equal to</td>
                    <td><code>filter=price ge 18</code></td>
                </tr>
                <tr>
                    <td>lt</td>
                    <td>Less than</td>
                    <td><code>filter=price lt 18</code></td>
                </tr>
                <tr>
                    <td>le</td>
                    <td>Less than or equal to</td>
                    <td><code>filter=price le 18</code></td>
                </tr>
                <tr>
                    <td>and</td>
                    <td>Logical AND</td>
                    <td><code>filter=price ge 18 and price le 30</code></td>
                </tr>
                <tr>
                    <td>or</td>
                    <td>Logical OR</td>
                    <td><code>filter=price lt 18 or price gt 30</code></td>
                </tr>
                <tr>
                    <td>not</td>
                    <td>Logical NOT</td>
                    <td><code>filter=not price eq 18</code></td>
                </tr>
            </table>
        </div>

        <h2>Data Types</h2>
        <p>The following data types are supported for filtering:</p>
        <div class="table-wrapper">
            <table>
                <tr>
                    <th>Data Type</th>
                    <th>Example</th>
                </tr>
                <tr>
                    <td>String</td>
                    <td><code>filter=name eq 'hellohq'</code></td>
                </tr>
                <tr>
                    <td>Boolean</td>
                    <td><code>filter=isActive eq true</code></td>
                </tr>
                <tr>
                    <td>Integer</td>
                    <td><code>filter=price eq 18</code></td>
                </tr>
                <tr>
                    <td>Decimal</td>
                    <td><code>filter=price eq 18.5</code></td>
                </tr>
                <tr>
                    <td>DateTime</td>
                    <td><code>filter=createdOn eq datetime'2021-01-01T12:00:00Z'</code></td>
                </tr>
            </table>
        </div>
    </div>

    <div id="v2_order" class="content">
        <h2>Ordering</h2>
        <p>To order the result set of your query, use the <code>orderby</code> parameter.</p>
        <p>Example: To order by the <code>UpdatedOn</code> property in descending order:</p>
        <div class="code-container" onclick="copyToClipboard(this)">
            <button class="copy-button">Copy</button>
            <pre><code class="language-http">GET /v2/projects?orderby=UpdatedOn desc</code></pre>
        </div>

        <p>You can also order by multiple properties, separated by a comma:</p>
        <div class="code-container" onclick="copyToClipboard(this)">
            <button class="copy-button">Copy</button>
            <pre><code class="language-http">GET /v2/users?orderby=LastName,FirstName desc</code></pre>
        </div>
    </div>

    <div id="v2_pagination" class="content">
        <h1>Pagination</h1>
        <p>
            Pagination helps control the number of items returned in a single response, improving performance and
            reducing data usage.
            The default limit is 1000 items per page. Use the <code>top</code> parameter to specify a different limit,
            up to a maximum of 1000 items.
        </p>
        <p>Use the <code>skip</code> parameter to skip a number of items:</p>
        <div class="code-container" onclick="copyToClipboard(this)">
            <button class="copy-button">Copy</button>
            <pre><code class="language-http">GET /v2/Companies?top=1000&skip=1000</code></pre>
        </div>
        <p>The response headers include:</p>
        <ul>
            <li><code>helloHQ-Count</code>: The total number of items in the collection.</li>
            <li><code>helloHQ-NextLink</code>: The URL for the next page of results. Empty if no more data is available.
            </li>
        </ul>
    </div>

    <div id="v2_rate" class="content">
        <h2>Rate Limits</h2>
        <p>The helloHQ API enforces rate limits to prevent abuse and ensure fair usage. The limit is set to <strong>1000
            requests per minute</strong>.</p>
        <p>If you exceed this limit, the API will return a <code>429 Too Many Requests</code> status code. Implement
            exponential backoff to handle rate limit responses gracefully.</p>
    </div>


    <div id="v2_endpoints" class="content">
        <h2>Endpoints</h2>
    </div>
</div>

<script>
    window.onload = function () {
        // Initialize Swagger UI for API v1
        const uiV1 = SwaggerUIBundle({
            url: "swagger19.json", // Location of Open API spec in the repo
            dom_id: '#v1_endpoints',
            defaultModelsExpandDepth: -1,
            deepLinking: true,
            presets: [
                SwaggerUIBundle.presets.apis,
                SwaggerUIBundle.SwaggerUIStandalonePreset
            ],
            plugins: [
                SwaggerUIBundle.plugins.DownloadUrl
            ]
        });

        // Initialize Swagger UI for API v2
        const uiV2 = SwaggerUIBundle({
            url: "swagger20.json", // Location of Open API spec in the repo
            dom_id: '#v2_endpoints',
            defaultModelsExpandDepth: -1,
            deepLinking: true,
            presets: [
                SwaggerUIBundle.presets.apis,
                SwaggerUIBundle.SwaggerUIStandalonePreset
            ],
            plugins: [
                SwaggerUIBundle.plugins.DownloadUrl
            ]
        });

    }
    // Copy code to clipboard
    function copyToClipboard(container) {
        const codeBlock = container.querySelector('code').innerText;
        navigator.clipboard.writeText(codeBlock);
    }

    // Scroll to the specific section
    function scrollToHeadline(id, event) {
        if (event) {
            event.preventDefault();
        }
        const headline = document.getElementById(id);
        if (headline) {
            const rect = headline.getBoundingClientRect();
            const contentWrapper = document.querySelector('#content-wrapper');
            const contentWrapperOffset = contentWrapper.offsetTop;
            const scrollPosition = rect.top + contentWrapper.scrollTop - contentWrapperOffset;
            contentWrapper.scrollTo({
                top: scrollPosition,
                behavior: 'smooth'
            });
        } else {
            console.log("Headline not found for ID:", id);
        }
    }

    // Show content based on the selected section
    function showContent(id, parentContentId) {
        var contents = document.querySelectorAll('.content');
        document.getElementById(id).style.display = 'block';

        const links = document.querySelectorAll('.navbar a');
        links.forEach(link => {
            link.classList.remove('active');
        });
        document.getElementById(parentContentId).classList.add('active');
    }
</script>
</body>
</html>
